{"ast":null,"code":"var _jsxFileName = \"/Users/bagjimin/Desktop/aichatbot-project/frontend/src/pages/PatientInfoPage.jsx\",\n  _s = $RefreshSig$();\n// src/pages/PatientInfoPage.jsx\nimport React, { useEffect, useMemo, useState } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport Header from \"../components/Header\";\nimport PatientHistoryCard from \"../components/PatientHistoryCard\";\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport default function PatientInfoPage() {\n  _s();\n  var _filteredNotes;\n  const {\n    patientId: routePatientId\n  } = useParams();\n  const [patientId, setPatientId] = useState(routePatientId || \"25-0000032\");\n\n  // .env 우선, 없으면 8000 기본값\n  const API_BASE = process.env.REACT_APP_API_BASE || \"http://localhost:8000\";\n  const [notes, setNotes] = useState([]); // 원본 전체\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(\"\");\n  const [selectedDate, setSelectedDate] = useState(\"\");\n\n  // 검색 상태 (히스토리 섹션에서 사용)\n  const [query, setQuery] = useState(\"\"); // 자유 검색(키워드/내용)\n  const [debounced, setDebounced] = useState(\"\"); // 간단 디바운스\n\n  // ocr_records.py의 라벨을 반영한 키워드-색상 매핑\n  const keywordColor = useMemo(() => ({\n    발열: \"#ef4444\",\n    // 발열\n    가래: \"#06b6d4\",\n    // 가래\n    자가배뇨: \"#8b5cf6\",\n    // 자가배뇨 못함\n    욕창: \"#f59e0b\",\n    // 욕창\n    통증: \"#f97316\",\n    // 통증\n    식사: \"#22c55e\",\n    // 식사\n    \"대소변 조절 못함\": \"#0ea5e9\",\n    // 파랑\n    \"수면장애\": \"#f97316\",\n    // 주황\n    \"자가배뇨 못함\": \"#8b5cf6\",\n    // 보라\n    \"파킨슨 증상 악화\": \"#ef4444\",\n    // 빨강\n    기타: \"#64748b\" // 회색\n  }), []);\n\n  // 데이터 로드\n  useEffect(() => {\n    let ignore = false;\n    async function fetchNotes() {\n      setLoading(true);\n      setError(\"\");\n      try {\n        const res = await fetch(`${API_BASE}/patients/${patientId}/nursing-notes`);\n        if (!res.ok) {\n          const {\n            detail\n          } = await res.json().catch(() => ({\n            detail: res.statusText\n          }));\n          throw new Error(detail || `API Error ${res.status}`);\n        }\n        const data = await res.json();\n        if (!ignore) {\n          // 백엔드가 이미 템플릿 반영(키워드/원인 매핑, '호전됨' 포함)한 JSON을 내려줌\n          setNotes(Array.isArray(data) ? data : []);\n          if (Array.isArray(data) && data.length > 0) {\n            setSelectedDate(data[data.length - 1].date); // 최신 날짜\n          } else {\n            setSelectedDate(\"\");\n          }\n          setQuery(\"\"); // 환자 변경 시 검색 초기화\n        }\n      } catch (e) {\n        if (!ignore) setError(e.message || \"불러오기에 실패했습니다.\");\n      } finally {\n        if (!ignore) setLoading(false);\n      }\n    }\n    fetchNotes();\n    return () => {\n      ignore = true;\n    };\n  }, [API_BASE, patientId]);\n\n  // 검색 디바운스 (250ms)\n  useEffect(() => {\n    const t = setTimeout(() => setDebounced(query.trim()), 250);\n    return () => clearTimeout(t);\n  }, [query]);\n\n  // 필터링(검색어: 키워드/내용 모두 대상)\n  const filteredNotes = useMemo(() => {\n    const q = debounced.toLowerCase();\n    if (!q) return notes;\n    return notes.map(d => {\n      const items = (d.items || []).filter(it => {\n        const kw = (it.keyword || \"기타\").toLowerCase();\n        const detail = (it.detail || \"\").toLowerCase();\n        return kw.includes(q) || detail.includes(q);\n      });\n      return {\n        ...d,\n        items\n      };\n    }).filter(d => (d.items || []).length > 0);\n  }, [notes, debounced]);\n\n  // 날짜 목록 / 선택 항목 (필터 결과 기준)\n  const dates = useMemo(() => filteredNotes.map(n => n.date), [filteredNotes]);\n  const selectedItems = useMemo(() => {\n    const day = filteredNotes.find(n => n.date === selectedDate);\n    return (day === null || day === void 0 ? void 0 : day.items) || [];\n  }, [filteredNotes, selectedDate]);\n\n  // 검색으로 인해 선택 날짜가 사라지면 자동 보정\n  useEffect(() => {\n    if (selectedDate && !dates.includes(selectedDate)) {\n      setSelectedDate(dates[dates.length - 1] || \"\");\n    }\n  }, [dates, selectedDate]);\n\n  // 키워드 요약(필터링된 결과 기준)\n  const keywordStats = useMemo(() => {\n    const counts = {};\n    for (const d of filteredNotes) {\n      for (const it of d.items || []) {\n        const k = it.keyword || \"기타\";\n        counts[k] = (counts[k] || 0) + 1;\n      }\n    }\n    return Object.entries(counts).sort((a, b) => b[1] - a[1]).map(([k, v]) => ({\n      keyword: k,\n      count: v\n    }));\n  }, [filteredNotes]);\n\n  // 현재 검색어가 특정 키워드와 정확히 일치하는지(배지 활성화 표시)\n  const isActiveKeyword = kw => debounced && debounced.toLowerCase() === String(kw).toLowerCase();\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: styles.page,\n    children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: styles.container,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: styles.topBar,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: styles.titleWrap,\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            style: styles.title,\n            children: \"\\uD658\\uC790 \\uC0C1\\uD0DC \\uC815\\uBCF4\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 141,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            style: styles.subtitle,\n            children: \"\\uAC04\\uD638\\uAE30\\uB85D\\uC9C0 \\uD2B9\\uC774\\uC0AC\\uD56D\\uC744 \\uB0A0\\uC9DC\\uBCC4\\uB85C \\uD655\\uC778\\uD569\\uB2C8\\uB2E4.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: styles.controls,\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            style: styles.label,\n            children: [\"\\uD658\\uC790\\uBC88\\uD638\", /*#__PURE__*/_jsxDEV(\"input\", {\n              value: patientId,\n              onChange: e => setPatientId(e.target.value.trim()),\n              style: styles.input,\n              placeholder: \"\\uC608: 25-0000032\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 150,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            style: styles.label,\n            children: [\"\\uB0A0\\uC9DC \\uC120\\uD0DD\", /*#__PURE__*/_jsxDEV(\"select\", {\n              value: selectedDate,\n              onChange: e => setSelectedDate(e.target.value),\n              style: styles.select,\n              children: [dates.length === 0 && /*#__PURE__*/_jsxDEV(\"option\", {\n                value: \"\",\n                children: \"\\uB370\\uC774\\uD130 \\uC5C6\\uC74C\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 165,\n                columnNumber: 40\n              }, this), dates.map(d => /*#__PURE__*/_jsxDEV(\"option\", {\n                value: d,\n                children: d\n              }, d, false, {\n                fileName: _jsxFileName,\n                lineNumber: 167,\n                columnNumber: 19\n              }, this))]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 160,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 9\n      }, this), loading && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: styles.stateBox,\n        children: \"\\uBD88\\uB7EC\\uC624\\uB294 \\uC911\\u2026\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 21\n      }, this), !!error && !loading && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          ...styles.stateBox,\n          color: \"#ef4444\"\n        },\n        children: [\"\\uC5D0\\uB7EC: \", error]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 11\n      }, this), !loading && !error && filteredNotes.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: styles.stateBox,\n        children: notes.length === 0 ? \"표시할 간호기록이 없습니다.\" : \"검색 결과가 없습니다.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 11\n      }, this), !loading && !error && filteredNotes.length > 0 && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: styles.cardsGrid,\n          children: [/*#__PURE__*/_jsxDEV(SummaryCard, {\n            title: \"\\uCD1D \\uAE30\\uB85D \\uC77C\\uC218(\\uD544\\uD130 \\uC801\\uC6A9)\",\n            value: `${filteredNotes.length}일`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 190,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(SummaryCard, {\n            title: \"\\uD0A4\\uC6CC\\uB4DC \\uC885\\uB958\",\n            value: `${keywordStats.length}개`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(SummaryCard, {\n            title: \"\\uAC00\\uC7A5 \\uCD5C\\uADFC \\uB0A0\\uC9DC\",\n            value: ((_filteredNotes = filteredNotes[filteredNotes.length - 1]) === null || _filteredNotes === void 0 ? void 0 : _filteredNotes.date) || \"-\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: styles.section,\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            style: styles.sectionTitle,\n            children: \"\\uD0A4\\uC6CC\\uB4DC \\uC694\\uC57D\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 200,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: styles.badgeWrap,\n            children: [keywordStats.length === 0 && /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"\\u2014 \\uC5C6\\uC74C \\u2014\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 202,\n              columnNumber: 47\n            }, this), keywordStats.map(({\n              keyword,\n              count\n            }) => /*#__PURE__*/_jsxDEV(Badge, {\n              text: `${keyword} ${count}`,\n              color: keywordColor[keyword] || keywordColor[\"기타\"],\n              isActive: isActiveKeyword(keyword),\n              onClick: () => setQuery(isActiveKeyword(keyword) ? \"\" : keyword) // 같은 배지 다시 클릭 → 해제\n            }, keyword, false, {\n              fileName: _jsxFileName,\n              lineNumber: 204,\n              columnNumber: 19\n            }, this))]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 201,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 199,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: styles.section,\n          children: /*#__PURE__*/_jsxDEV(PatientHistoryCard, {\n            date: selectedDate,\n            items: selectedItems,\n            keywordColor: keywordColor,\n            highlightQuery: debounced\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: styles.section,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: styles.sectionHeader,\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              style: styles.sectionTitle,\n              children: \"\\uC804\\uCCB4 \\uD788\\uC2A4\\uD1A0\\uB9AC\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 230,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: {\n                position: \"relative\"\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                value: query,\n                onChange: e => setQuery(e.target.value),\n                style: {\n                  ...styles.input,\n                  paddingRight: 28,\n                  minWidth: 240\n                },\n                placeholder: \"\\uD0A4\\uC6CC\\uB4DC/\\uB0B4\\uC6A9 \\uAC80\\uC0C9\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 232,\n                columnNumber: 19\n              }, this), !!query && /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => setQuery(\"\"),\n                style: styles.clearBtn,\n                title: \"\\uAC80\\uC0C9\\uC5B4 \\uC9C0\\uC6B0\\uAE30\",\n                children: \"\\xD7\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 239,\n                columnNumber: 21\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 231,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: styles.timelineGrid,\n            children: [...filteredNotes].reverse().map(d => /*#__PURE__*/_jsxDEV(PatientHistoryCard, {\n              date: d.date,\n              items: d.items || [],\n              keywordColor: keywordColor,\n              highlightQuery: debounced\n            }, d.date, false, {\n              fileName: _jsxFileName,\n              lineNumber: 252,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 250,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 134,\n    columnNumber: 5\n  }, this);\n}\n\n/* ===== Sub components ===== */\n_s(PatientInfoPage, \"qdm3EhTA3csz/AxYrlCNj6GqLcI=\", false, function () {\n  return [useParams];\n});\n_c = PatientInfoPage;\nfunction SummaryCard({\n  title,\n  value\n}) {\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: styles.card,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: styles.cardTitle,\n      children: title\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 274,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: styles.cardValue,\n      children: value\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 275,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 273,\n    columnNumber: 5\n  }, this);\n}\n_c2 = SummaryCard;\nfunction Badge({\n  text,\n  color = \"#64748b\",\n  onClick,\n  isActive = false\n}) {\n  return /*#__PURE__*/_jsxDEV(\"button\", {\n    type: \"button\",\n    onClick: onClick,\n    style: {\n      display: \"inline-block\",\n      padding: \"6px 10px\",\n      borderRadius: 999,\n      background: isActive ? `${color}30` : `${color}20`,\n      color,\n      fontSize: 13,\n      fontWeight: 700,\n      margin: \"4px 8px 4px 0\",\n      border: `1px solid ${isActive ? color : \"transparent\"}`,\n      cursor: \"pointer\"\n    },\n    title: isActive ? \"필터 해제\" : \"이 키워드로 필터\",\n    children: text\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 282,\n    columnNumber: 5\n  }, this);\n}\n\n/* ===== Styles ===== */\n_c3 = Badge;\nconst styles = {\n  page: {\n    minHeight: \"100vh\",\n    background: \"#f8fafc\"\n  },\n  container: {\n    maxWidth: 1100,\n    margin: \"0 auto\",\n    padding: \"20px 16px 48px\"\n  },\n  topBar: {\n    display: \"flex\",\n    alignItems: \"flex-end\",\n    justifyContent: \"space-between\",\n    gap: 16,\n    margin: \"12px 0 20px\",\n    flexWrap: \"wrap\"\n  },\n  titleWrap: {\n    maxWidth: 640\n  },\n  title: {\n    margin: 0,\n    fontSize: 24,\n    fontWeight: 800,\n    color: \"#0f172a\"\n  },\n  subtitle: {\n    margin: \"6px 0 0\",\n    color: \"#475569\"\n  },\n  controls: {\n    display: \"flex\",\n    gap: 12,\n    flexWrap: \"wrap\"\n  },\n  label: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    fontSize: 13,\n    color: \"#334155\"\n  },\n  input: {\n    height: 38,\n    border: \"1px solid #e5e7eb\",\n    borderRadius: 10,\n    padding: \"0 12px\",\n    minWidth: 180,\n    outline: \"none\",\n    background: \"#fff\"\n  },\n  select: {\n    height: 38,\n    border: \"1px solid #e5e7eb\",\n    borderRadius: 10,\n    padding: \"0 12px\",\n    minWidth: 160,\n    outline: \"none\",\n    background: \"#fff\"\n  },\n  stateBox: {\n    background: \"#fff\",\n    border: \"1px dashed #e5e7eb\",\n    borderRadius: 14,\n    padding: 18,\n    textAlign: \"center\",\n    color: \"#334155\"\n  },\n  cardsGrid: {\n    display: \"grid\",\n    gridTemplateColumns: \"repeat(3, minmax(0, 1fr))\",\n    gap: 12,\n    marginTop: 8\n  },\n  card: {\n    background: \"#fff\",\n    border: \"1px solid #e5e7eb\",\n    borderRadius: 16,\n    padding: 16,\n    boxShadow: \"0 1px 2px rgba(0,0,0,0.03)\"\n  },\n  cardTitle: {\n    fontSize: 12,\n    color: \"#6b7280\",\n    marginBottom: 6\n  },\n  cardValue: {\n    fontSize: 22,\n    fontWeight: 800,\n    color: \"#0f172a\"\n  },\n  section: {\n    marginTop: 28\n  },\n  // 섹션 타이틀 + 우측 검색창 정렬\n  sectionHeader: {\n    display: \"flex\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    marginBottom: 10,\n    gap: 12\n  },\n  sectionTitle: {\n    fontSize: 16,\n    fontWeight: 800,\n    margin: 0,\n    color: \"#0f172a\"\n  },\n  badgeWrap: {\n    display: \"flex\",\n    flexWrap: \"wrap\"\n  },\n  // 검색 X 버튼\n  clearBtn: {\n    position: \"absolute\",\n    right: 6,\n    top: 6,\n    width: 20,\n    height: 20,\n    borderRadius: 999,\n    border: \"1px solid #e5e7eb\",\n    background: \"#fff\",\n    cursor: \"pointer\",\n    lineHeight: \"16px\",\n    fontSize: 14\n  },\n  // 카드형 목록 레이아웃\n  timelineGrid: {\n    display: \"grid\",\n    gridTemplateColumns: \"repeat(2, minmax(0,1fr))\",\n    gap: 12\n  }\n};\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"PatientInfoPage\");\n$RefreshReg$(_c2, \"SummaryCard\");\n$RefreshReg$(_c3, \"Badge\");","map":{"version":3,"names":["React","useEffect","useMemo","useState","useParams","Header","PatientHistoryCard","jsxDEV","_jsxDEV","Fragment","_Fragment","PatientInfoPage","_s","_filteredNotes","patientId","routePatientId","setPatientId","API_BASE","process","env","REACT_APP_API_BASE","notes","setNotes","loading","setLoading","error","setError","selectedDate","setSelectedDate","query","setQuery","debounced","setDebounced","keywordColor","발열","가래","자가배뇨","욕창","통증","식사","기타","ignore","fetchNotes","res","fetch","ok","detail","json","catch","statusText","Error","status","data","Array","isArray","length","date","e","message","t","setTimeout","trim","clearTimeout","filteredNotes","q","toLowerCase","map","d","items","filter","it","kw","keyword","includes","dates","n","selectedItems","day","find","keywordStats","counts","k","Object","entries","sort","a","b","v","count","isActiveKeyword","String","style","styles","page","children","fileName","_jsxFileName","lineNumber","columnNumber","container","topBar","titleWrap","title","subtitle","controls","label","value","onChange","target","input","placeholder","select","stateBox","color","cardsGrid","SummaryCard","section","sectionTitle","badgeWrap","Badge","text","isActive","onClick","highlightQuery","sectionHeader","position","paddingRight","minWidth","clearBtn","timelineGrid","reverse","_c","card","cardTitle","cardValue","_c2","type","display","padding","borderRadius","background","fontSize","fontWeight","margin","border","cursor","_c3","minHeight","maxWidth","alignItems","justifyContent","gap","flexWrap","flexDirection","height","outline","textAlign","gridTemplateColumns","marginTop","boxShadow","marginBottom","right","top","width","lineHeight","$RefreshReg$"],"sources":["/Users/bagjimin/Desktop/aichatbot-project/frontend/src/pages/PatientInfoPage.jsx"],"sourcesContent":["// src/pages/PatientInfoPage.jsx\nimport React, { useEffect, useMemo, useState } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport Header from \"../components/Header\";\nimport PatientHistoryCard from \"../components/PatientHistoryCard\";\n\nexport default function PatientInfoPage() {\n  const { patientId: routePatientId } = useParams();\n  const [patientId, setPatientId] = useState(routePatientId || \"25-0000032\");\n\n  // .env 우선, 없으면 8000 기본값\n  const API_BASE = process.env.REACT_APP_API_BASE || \"http://localhost:8000\";\n\n  const [notes, setNotes] = useState([]);        // 원본 전체\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(\"\");\n  const [selectedDate, setSelectedDate] = useState(\"\");\n\n  // 검색 상태 (히스토리 섹션에서 사용)\n  const [query, setQuery] = useState(\"\");         // 자유 검색(키워드/내용)\n  const [debounced, setDebounced] = useState(\"\"); // 간단 디바운스\n\n  // ocr_records.py의 라벨을 반영한 키워드-색상 매핑\n  const keywordColor = useMemo(\n    () => ({\n      발열: \"#ef4444\",         // 발열\n      가래: \"#06b6d4\",         // 가래\n      자가배뇨: \"#8b5cf6\",     // 자가배뇨 못함\n      욕창: \"#f59e0b\",         // 욕창\n      통증: \"#f97316\",         // 통증\n      식사: \"#22c55e\",         // 식사\n      \"대소변 조절 못함\": \"#0ea5e9\",   // 파랑\n      \"수면장애\": \"#f97316\",         // 주황\n      \"자가배뇨 못함\": \"#8b5cf6\",    // 보라\n      \"파킨슨 증상 악화\": \"#ef4444\", // 빨강\n      기타: \"#64748b\",               // 회색\n    }),\n    []\n  );\n\n\n  // 데이터 로드\n  useEffect(() => {\n    let ignore = false;\n    async function fetchNotes() {\n      setLoading(true);\n      setError(\"\");\n      try {\n        const res = await fetch(`${API_BASE}/patients/${patientId}/nursing-notes`);\n        if (!res.ok) {\n          const { detail } = await res.json().catch(() => ({ detail: res.statusText }));\n          throw new Error(detail || `API Error ${res.status}`);\n        }\n        const data = await res.json();\n        if (!ignore) {\n          // 백엔드가 이미 템플릿 반영(키워드/원인 매핑, '호전됨' 포함)한 JSON을 내려줌\n          setNotes(Array.isArray(data) ? data : []);\n          if (Array.isArray(data) && data.length > 0) {\n            setSelectedDate(data[data.length - 1].date); // 최신 날짜\n          } else {\n            setSelectedDate(\"\");\n          }\n          setQuery(\"\"); // 환자 변경 시 검색 초기화\n        }\n      } catch (e) {\n        if (!ignore) setError(e.message || \"불러오기에 실패했습니다.\");\n      } finally {\n        if (!ignore) setLoading(false);\n      }\n    }\n    fetchNotes();\n    return () => {\n      ignore = true;\n    };\n  }, [API_BASE, patientId]);\n\n  // 검색 디바운스 (250ms)\n  useEffect(() => {\n    const t = setTimeout(() => setDebounced(query.trim()), 250);\n    return () => clearTimeout(t);\n  }, [query]);\n\n  // 필터링(검색어: 키워드/내용 모두 대상)\n  const filteredNotes = useMemo(() => {\n    const q = debounced.toLowerCase();\n    if (!q) return notes;\n\n    return notes\n      .map((d) => {\n        const items = (d.items || []).filter((it) => {\n          const kw = (it.keyword || \"기타\").toLowerCase();\n          const detail = (it.detail || \"\").toLowerCase();\n          return kw.includes(q) || detail.includes(q);\n        });\n        return { ...d, items };\n      })\n      .filter((d) => (d.items || []).length > 0);\n  }, [notes, debounced]);\n\n  // 날짜 목록 / 선택 항목 (필터 결과 기준)\n  const dates = useMemo(() => filteredNotes.map((n) => n.date), [filteredNotes]);\n\n  const selectedItems = useMemo(() => {\n    const day = filteredNotes.find((n) => n.date === selectedDate);\n    return day?.items || [];\n  }, [filteredNotes, selectedDate]);\n\n  // 검색으로 인해 선택 날짜가 사라지면 자동 보정\n  useEffect(() => {\n    if (selectedDate && !dates.includes(selectedDate)) {\n      setSelectedDate(dates[dates.length - 1] || \"\");\n    }\n  }, [dates, selectedDate]);\n\n  // 키워드 요약(필터링된 결과 기준)\n  const keywordStats = useMemo(() => {\n    const counts = {};\n    for (const d of filteredNotes) {\n      for (const it of (d.items || [])) {\n        const k = it.keyword || \"기타\";\n        counts[k] = (counts[k] || 0) + 1;\n      }\n    }\n    return Object.entries(counts)\n      .sort((a, b) => b[1] - a[1])\n      .map(([k, v]) => ({ keyword: k, count: v }));\n  }, [filteredNotes]);\n\n  // 현재 검색어가 특정 키워드와 정확히 일치하는지(배지 활성화 표시)\n  const isActiveKeyword = (kw) =>\n    debounced && debounced.toLowerCase() === String(kw).toLowerCase();\n\n  return (\n    <div style={styles.page}>\n      <Header />\n\n      <div style={styles.container}>\n        {/* 상단 바: 환자/날짜 (검색은 히스토리 섹션으로 이동) */}\n        <div style={styles.topBar}>\n          <div style={styles.titleWrap}>\n            <h2 style={styles.title}>환자 상태 정보</h2>\n            <p style={styles.subtitle}>\n              간호기록지 특이사항을 날짜별로 확인합니다.\n            </p>\n          </div>\n\n          <div style={styles.controls}>\n            <label style={styles.label}>\n              환자번호\n              <input\n                value={patientId}\n                onChange={(e) => setPatientId(e.target.value.trim())}\n                style={styles.input}\n                placeholder=\"예: 25-0000032\"\n              />\n            </label>\n\n            <label style={styles.label}>\n              날짜 선택\n              <select\n                value={selectedDate}\n                onChange={(e) => setSelectedDate(e.target.value)}\n                style={styles.select}\n              >\n                {dates.length === 0 && <option value=\"\">데이터 없음</option>}\n                {dates.map((d) => (\n                  <option key={d} value={d}>\n                    {d}\n                  </option>\n                ))}\n              </select>\n            </label>\n          </div>\n        </div>\n\n        {loading && <div style={styles.stateBox}>불러오는 중…</div>}\n        {!!error && !loading && (\n          <div style={{ ...styles.stateBox, color: \"#ef4444\" }}>에러: {error}</div>\n        )}\n        {!loading && !error && filteredNotes.length === 0 && (\n          <div style={styles.stateBox}>\n            {notes.length === 0 ? \"표시할 간호기록이 없습니다.\" : \"검색 결과가 없습니다.\"}\n          </div>\n        )}\n\n        {!loading && !error && filteredNotes.length > 0 && (\n          <>\n            {/* 요약 카드 (필터링 결과 기준) */}\n            <div style={styles.cardsGrid}>\n              <SummaryCard title=\"총 기록 일수(필터 적용)\" value={`${filteredNotes.length}일`} />\n              <SummaryCard title=\"키워드 종류\" value={`${keywordStats.length}개`} />\n              <SummaryCard\n                title=\"가장 최근 날짜\"\n                value={filteredNotes[filteredNotes.length - 1]?.date || \"-\"}\n              />\n            </div>\n\n            {/* 키워드 요약 (배지 클릭: 토글) */}\n            <div style={styles.section}>\n              <h3 style={styles.sectionTitle}>키워드 요약</h3>\n              <div style={styles.badgeWrap}>\n                {keywordStats.length === 0 && <span>— 없음 —</span>}\n                {keywordStats.map(({ keyword, count }) => (\n                  <Badge\n                    key={keyword}\n                    text={`${keyword} ${count}`}\n                    color={keywordColor[keyword] || keywordColor[\"기타\"]}\n                    isActive={isActiveKeyword(keyword)}\n                    onClick={() =>\n                      setQuery(isActiveKeyword(keyword) ? \"\" : keyword) // 같은 배지 다시 클릭 → 해제\n                    }\n                  />\n                ))}\n              </div>\n            </div>\n\n            {/* 선택된 날짜 카드 — 상단 날짜 헤더 제거(중복 방지) */}\n            <div style={styles.section}>\n              <PatientHistoryCard\n                date={selectedDate}\n                items={selectedItems}\n                keywordColor={keywordColor}\n                highlightQuery={debounced}\n              />\n            </div>\n\n            {/* 전체 히스토리 카드 목록 (검색창을 타이틀 옆으로 배치) */}\n            <div style={styles.section}>\n              <div style={styles.sectionHeader}>\n                <h3 style={styles.sectionTitle}>전체 히스토리</h3>\n                <div style={{ position: \"relative\" }}>\n                  <input\n                    value={query}\n                    onChange={(e) => setQuery(e.target.value)}\n                    style={{ ...styles.input, paddingRight: 28, minWidth: 240 }}\n                    placeholder=\"키워드/내용 검색\"\n                  />\n                  {!!query && (\n                    <button\n                      onClick={() => setQuery(\"\")}\n                      style={styles.clearBtn}\n                      title=\"검색어 지우기\"\n                    >\n                      ×\n                    </button>\n                  )}\n                </div>\n              </div>\n\n              <div style={styles.timelineGrid}>\n                {[...filteredNotes].reverse().map((d) => (\n                  <PatientHistoryCard\n                    key={d.date}\n                    date={d.date}\n                    items={d.items || []}\n                    keywordColor={keywordColor}\n                    highlightQuery={debounced}\n                  />\n                ))}\n              </div>\n            </div>\n          </>\n        )}\n      </div>\n    </div>\n  );\n}\n\n/* ===== Sub components ===== */\n\nfunction SummaryCard({ title, value }) {\n  return (\n    <div style={styles.card}>\n      <div style={styles.cardTitle}>{title}</div>\n      <div style={styles.cardValue}>{value}</div>\n    </div>\n  );\n}\n\nfunction Badge({ text, color = \"#64748b\", onClick, isActive = false }) {\n  return (\n    <button\n      type=\"button\"\n      onClick={onClick}\n      style={{\n        display: \"inline-block\",\n        padding: \"6px 10px\",\n        borderRadius: 999,\n        background: isActive ? `${color}30` : `${color}20`,\n        color,\n        fontSize: 13,\n        fontWeight: 700,\n        margin: \"4px 8px 4px 0\",\n        border: `1px solid ${isActive ? color : \"transparent\"}`,\n        cursor: \"pointer\",\n      }}\n      title={isActive ? \"필터 해제\" : \"이 키워드로 필터\"}\n    >\n      {text}\n    </button>\n  );\n}\n\n/* ===== Styles ===== */\n\nconst styles = {\n  page: {\n    minHeight: \"100vh\",\n    background: \"#f8fafc\",\n  },\n  container: {\n    maxWidth: 1100,\n    margin: \"0 auto\",\n    padding: \"20px 16px 48px\",\n  },\n  topBar: {\n    display: \"flex\",\n    alignItems: \"flex-end\",\n    justifyContent: \"space-between\",\n    gap: 16,\n    margin: \"12px 0 20px\",\n    flexWrap: \"wrap\",\n  },\n  titleWrap: { maxWidth: 640 },\n  title: { margin: 0, fontSize: 24, fontWeight: 800, color: \"#0f172a\" },\n  subtitle: { margin: \"6px 0 0\", color: \"#475569\" },\n  controls: { display: \"flex\", gap: 12, flexWrap: \"wrap\" },\n  label: { display: \"flex\", flexDirection: \"column\", fontSize: 13, color: \"#334155\" },\n  input: {\n    height: 38,\n    border: \"1px solid #e5e7eb\",\n    borderRadius: 10,\n    padding: \"0 12px\",\n    minWidth: 180,\n    outline: \"none\",\n    background: \"#fff\",\n  },\n  select: {\n    height: 38,\n    border: \"1px solid #e5e7eb\",\n    borderRadius: 10,\n    padding: \"0 12px\",\n    minWidth: 160,\n    outline: \"none\",\n    background: \"#fff\",\n  },\n  stateBox: {\n    background: \"#fff\",\n    border: \"1px dashed #e5e7eb\",\n    borderRadius: 14,\n    padding: 18,\n    textAlign: \"center\",\n    color: \"#334155\",\n  },\n  cardsGrid: {\n    display: \"grid\",\n    gridTemplateColumns: \"repeat(3, minmax(0, 1fr))\",\n    gap: 12,\n    marginTop: 8,\n  },\n  card: {\n    background: \"#fff\",\n    border: \"1px solid #e5e7eb\",\n    borderRadius: 16,\n    padding: 16,\n    boxShadow: \"0 1px 2px rgba(0,0,0,0.03)\",\n  },\n  cardTitle: { fontSize: 12, color: \"#6b7280\", marginBottom: 6 },\n  cardValue: { fontSize: 22, fontWeight: 800, color: \"#0f172a\" },\n  section: { marginTop: 28 },\n\n  // 섹션 타이틀 + 우측 검색창 정렬\n  sectionHeader: {\n    display: \"flex\",\n    justifyContent: \"space-between\",\n    alignItems: \"center\",\n    marginBottom: 10,\n    gap: 12,\n  },\n\n  sectionTitle: { fontSize: 16, fontWeight: 800, margin: 0, color: \"#0f172a\" },\n  badgeWrap: { display: \"flex\", flexWrap: \"wrap\" },\n\n  // 검색 X 버튼\n  clearBtn: {\n    position: \"absolute\",\n    right: 6,\n    top: 6,\n    width: 20,\n    height: 20,\n    borderRadius: 999,\n    border: \"1px solid #e5e7eb\",\n    background: \"#fff\",\n    cursor: \"pointer\",\n    lineHeight: \"16px\",\n    fontSize: 14,\n  },\n\n  // 카드형 목록 레이아웃\n  timelineGrid: {\n    display: \"grid\",\n    gridTemplateColumns: \"repeat(2, minmax(0,1fr))\",\n    gap: 12,\n  },\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}